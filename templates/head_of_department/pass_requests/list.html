{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>–ó–∞—è–≤–∫–∏ –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∞</h2>
        <div>
            <a href="{{ url_for('manage_dictionaries') }}" class="btn btn-info me-2">
                <i class="bi bi-gear"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞–º–∏
            </a>
            <a href="{{ url_for('create_pass_request', request_type='internal') }}" class="btn btn-success">–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–æ—Å—Ç—ã</a>
            <a href="{{ url_for('create_pass_request', request_type='border') }}" class="btn btn-success">–ì—Ä–∞–Ω–∏—Ü–∞ –í–ß–ù–ì</a>
            <a href="{{ url_for('create_pass_request', request_type='sng') }}" class="btn btn-success">–°—É—Ä–≥—É—Ç–Ω–µ—Ñ—Ç–µ–≥–∞–∑</a>
        </div>
    </div>

    <!-- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
    <div class="row mb-3">
        <div class="col-md-6">
            <input type="text" class="form-control" placeholder="–ü–æ–∏—Å–∫ –∑–∞—è–≤–æ–∫..." id="searchInput">
        </div>
        <div class="col-md-3">
            <select class="form-select" id="typeFilter">
                <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                <option value="internal">–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ</option>
                <option value="border">–ì—Ä–∞–Ω–∏—Ü–∞ –í–ß–ù–ì</option>
                <option value="sng">–°—É—Ä–≥—É—Ç–Ω–µ—Ñ—Ç–µ–≥–∞–∑</option>
            </select>
        </div>
        <div class="col-md-3">
            <select class="form-select" id="statusFilter">
                <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                <option value="draft">–ß–µ—Ä–Ω–æ–≤–∏–∫</option>
                <option value="approved">–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ</option>
                <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–æ</option>
            </select>
        </div>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ -->
    <div class="card">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th>‚Ññ</th>
                            <th>–¢–∏–ø –∑–∞—è–≤–∫–∏</th>
                            <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                            <th>–ü–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for req in requests %}
                        <tr>
                            <td>{{ req.id }}</td>
                            <td>
                                {% if req.request_type == 'internal' %}
                                –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–æ—Å—Ç—ã
                                {% elif req.request_type == 'border' %}
                                –ì—Ä–∞–Ω–∏—Ü–∞ –í–ß–ù–ì
                                {% else %}
                                –°—É—Ä–≥—É—Ç–Ω–µ—Ñ—Ç–µ–≥–∞–∑
                                {% endif %}
                            </td>
                            <td>{{ req.created_at.strftime('%d.%m.%Y') }}</td>
                            <td>{{ req.start_date.strftime('%d.%m.%Y') }} - {{ req.end_date.strftime('%d.%m.%Y') }}</td>
                            <td>
                                <span class="badge bg-{{ 'warning' if req.status == 'draft' else 'success' if req.status == 'approved' else 'info' }}">
                                    {{ req.status }}
                                </span>
                            </td>
                            <td>
                                <a href="#" class="btn btn-sm btn-info" title="–ü—Ä–æ—Å–º–æ—Ç—Ä">üëÅÔ∏è</a>
                                <a href="#" class="btn btn-sm btn-warning" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</a>
                                <a href="#" class="btn btn-sm btn-primary" title="–°–∫–∞—á–∞—Ç—å">üìÑ</a>
                                <button class="btn btn-sm btn-danger" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                            </td>
                        </tr>
                        {% else %}
                        <tr>
                            <td colspan="6" class="text-center">–ó–∞—è–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ -->
    <div class="mt-3">
        <a href="{{ url_for('head_of_department_index') }}" class="btn btn-secondary">–ù–∞–∑–∞–¥</a>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
TableFilter.initSearch('searchInput', 'table');
TableFilter.initSelectFilter('typeFilter', 1, 'table');
TableFilter.initSelectFilter('statusFilter', 4, 'table');
</script>
{% endblock %}